const axios = require('axios');

module.exports = async function (sock, chatId) {
    try {
        const apiKey = 'dcd720a6f1914e2d9dba9790c188c08c';  // Replace with your NewsAPI key
        const response = await axios.get(`https://newsapi.org/v2/top-headlines?country=us&apiKey=${apiKey}`);
        const articles = response.data.articles.slice(0, 5); // Get top 5 articles
        
        let newsMessage = `
â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ      ğŸ“° *LATEST NEWS*      â”ƒ
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯
`.trim();

        articles.forEach((article, index) => {
            newsMessage += `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ *${index + 1}. ${article.title}*
â”‚ ${article.description || 'No description available'}
â”‚ 
â”‚ Read more: ${article.url}
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`;
        });

        await sock.sendMessage(chatId, { 
            image: { url: 'https://files.catbox.moe/wpt5p6.jpg' },
            caption: newsMessage,
            contextInfo: {
                forwardingScore: 1,
                isForwarded: true,
                forwardedNewsletterMessageInfo: {
                    newsletterJid: '120363401680775438@newsletter',
                    newsletterName: 'ğ™ğ”ğŠğ-ğŒğƒ',
                    serverMessageId: -1
                }
            }
        });
    } catch (error) {
        console.error('Error fetching news:', error);
        await sock.sendMessage(chatId, { 
            text: 'â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®\nâ”ƒ   âŒ NEWS FETCH ERROR   â”ƒ\nâ•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯\nSorry, I could not fetch news right now.' 
        });
    }
};